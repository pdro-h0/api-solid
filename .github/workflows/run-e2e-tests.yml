name: Run Unit Test

on: [push]

jobs:
  run-unit-test:
    name: Run Unit Tests
    runs-on: ubuntu-latest

    services:
  api-solid-pg:
    images: bitnami/postgresql
    ports:
      - 5433:5432
    environment:
      POSTGRESQL_USERNAME: docker
      POSTGRESQL_PASSWORD: docker
      POSTGRESQL_DATABASE: apisolid

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: "npm"
      - run: npm ci
      - run: npm run test:e2e
      env:
          JWT_SECRET: testing
          DATABASE_URL: "postgresql://docker:docker@localhost:5432/apisolid?schema=public"